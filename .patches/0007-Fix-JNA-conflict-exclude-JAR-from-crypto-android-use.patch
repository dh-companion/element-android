From 776fc6c76a813138c0432d7d2b287f7f736cbbee Mon Sep 17 00:00:00 2001
From: LukaRusadze <rusadzeluka@gmail.com>
Date: Tue, 13 Jan 2026 17:02:06 +0400
Subject: [PATCH] Fix JNA conflict: exclude JAR from crypto-android, use AAR
 5.14.0

---
 matrix-sdk-android/build.gradle | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)

diff --git a/matrix-sdk-android/build.gradle b/matrix-sdk-android/build.gradle
index ee379f30a7..705a1e4d90 100644
--- a/matrix-sdk-android/build.gradle
+++ b/matrix-sdk-android/build.gradle
@@ -175,7 +175,8 @@ dependencies {
 
 
 //    implementation(name: 'crypto-android-release', ext: 'aar')
-    implementation 'net.java.dev.jna:jna:5.13.0@aar'
+    // JNA AAR - must match version required by crypto-android (5.14.0)
+    implementation 'net.java.dev.jna:jna:5.14.0@aar'
 
  //   implementation libs.androidx.appCompat
     implementation libs.androidx.core
@@ -235,7 +236,10 @@ dependencies {
 
     implementation libs.google.phonenumber
 
-    implementation("org.matrix.rustcomponents:crypto-android:0.11.1")
+    implementation("org.matrix.rustcomponents:crypto-android:0.11.1") {
+        // Exclude JNA JAR - we declare JNA AAR explicitly above
+        exclude group: 'net.java.dev.jna', module: 'jna'
+    }
 //    api project(":library:rustCrypto")
 
     testImplementation libs.tests.junit
-- 
2.39.5 (Apple Git-154)

